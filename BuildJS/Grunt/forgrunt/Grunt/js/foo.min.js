function redirect(a){window.location=a}function loader(a){"on"==a?($("#login_form").css({opacity:.2}),$("#loading").show()):($("#login_form").css({opacity:1}),$("#loading").hide())}function getUrlVars(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("/")+1).split("/"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b}function getJob(a){$.ajax({url:"/job/joblist?page="+a}).done(function(b){$("#ajax_pagi").html(b),location.hash=a})}function addCommas(a){a+="",x=a.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var b=/(\d+)(\d{3})/;b.test(x1);)x1=x1.replace(b,"$1,$2");return x1+x2}function ConfirmDelete(){var a=confirm("Bạn có chắc chắn muốn xóa");return!!a}$(document).ready(function(){$("#login_form").formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{usernameLogin:{validators:{notEmpty:{message:"Vui lòng nhập tên đăng nhập"}}},passwordLogin:{validators:{notEmpty:{message:"Vui lòng nhập mật khẩu"}}}}}).on("success.form.fv",function(a){a.preventDefault();var b=$("#login_form").serializeArray(),c=$("#login_form").attr("action");loader("on"),$.post(c,b,function(a){loader("off"),"fail"==a?($("#message").text("Username hoặc password sai hoặc tài khoản chưa kích hoạt"),$("#message").show()):($("#message").text("Đăng nhập thành công vui lòng đợi ....."),$("#message").show(),redirect("/trang-chu"))})})}),$(document).ready(function(){function a(a,b){return Math.floor(Math.random()*(b-a+1)+a)}$("#captchaOperation").html([a(1,100),"+",a(1,200),"="].join(" ")),$("#register_form_popup").formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{usernameRegis:{validators:{notEmpty:{message:"Vui lòng nhập tên đăng nhập"},stringLength:{min:5,max:30,message:"Tên đăng nhập phải từ 5 - 30 kí tự"},regexp:{regexp:/^[a-zA-Z0-9_\.]+$/,message:"Tên đăng nhập chỉ gồm chữ,số,dấu ., dấu _ "}}},fullnameRegis:{validators:{notEmpty:{message:"Vui lòng nhập tên hiển thị"}}},emailRegis:{validators:{notEmpty:{message:"Vui lòng nhập email"},emailAddress:{message:"Email không hợp lệ"}}},passwordRegis:{validators:{notEmpty:{message:"Vui lòng nhập mật khẩu"},stringLength:{min:5,max:30,message:"Mật khẩu phải từ 5 - 30 kí tự"}}},rePassword:{validators:{notEmpty:{message:"Vui lòng nhập lại mật khẩu"},identical:{field:"passwordRegis",message:"Mật khẩu bạn nhập không trùng"}}},captcha:{validators:{callback:{message:"Kết quả sai",callback:function(a,b,c){var d=$("#captchaOperation").html().split(" "),e=parseInt(d[0])+parseInt(d[2]);return a==e}}}}}}).on("success.form.fv",function(a){a.preventDefault();var b=$("#register_form_popup").serializeArray(),c=$(a.target);c.ajaxSubmit({url:"/user/register",type:"POST",data:b,success:function(a){alert(a.mess),window.location.reload()},error:function(a){alert("Có lỗi xảy ra vui lòng thử lại")}})})}),$(document).ready(function(){$("#commentForm").formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{allowance:{validators:{notEmpty:{message:"Vui lòng nhập kinh phí"},hex:{message:"Kinh phí phải là số"}}},completed_day:{validators:{notEmpty:{message:"Vui lòng nhập ngày hoàn thành"},hex:{message:"Ngày hoàn thành phải là số"}}},introduce:{validators:{notEmpty:{message:"Vui lòng nhập giới thiệu bản thân"}}}}}).on("success.form.fv",function(a){a.preventDefault();var b=$("#commentForm").serializeArray(),c=$(a.target);c.ajaxSubmit({url:"/postComment",type:"POST",data:b,success:function(a){alert(a.mess),window.location.reload(),$("#commentForm")[0].reset()},error:function(a){alert(a.err)}})})}),$(document).ready(function(){$("#formNewPassword").formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{newpassword:{validators:{notEmpty:{message:"Vui lòng nhập mật khẩu"},stringLength:{min:5,max:30,message:"Mật khẩu nhập phải từ 5 - 30 kí tự"}}},repassword:{validators:{notEmpty:{message:"Vui lòng nhập mật khẩu"},stringLength:{min:5,max:30,message:"Mật khẩu nhập phải từ 5 - 30 kí tự"},identical:{field:"newpassword",message:"Mật khẩu bạn nhập không trùng"}}}}}).on("success.form.fv",function(a){a.preventDefault();var b=$("#formNewPassword").serialize(),c=$(a.target);c.ajaxSubmit({url:"/updatePassword",type:"POST",data:b,success:function(a){alert(a.mess),$("#formNewPassword")[0].reset()},error:function(){alert("Có lỗi xảy ra vui lòng thử lại")}})})}),$(document).ready(function(){$("#forgotpassForm").formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{emailForgot:{validators:{notEmpty:{message:"Vui lòng nhập tên email"}}}}}).on("success.form.fv",function(a){a.preventDefault();var b=$("#forgotpassForm").serializeArray(),c=$(a.target);c.ajaxSubmit({url:"/findPassword",type:"POST",data:b,success:function(a){alert(a.mess),$("#forgotpassForm")[0].reset()},error:function(){alert("Có lỗi xảy ra vui lòng thử lại")}})})}),$(document).ready(function(){$("#newpassReset").formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{newpassword:{validators:{notEmpty:{message:"Vui lòng nhập mật khẩu"},stringLength:{min:5,max:30,message:"Mật khẩu phải từ 5 - 30 kí tự"}}}}}).on("success.form.fv",function(a){a.preventDefault();var b=$("#newpassReset").serializeArray(),c=$(a.target);c.ajaxSubmit({url:"/password/new",type:"POST",data:b,success:function(a){alert(a.mess),$("#newpassReset")[0].reset()},error:function(){alert("Có lỗi xảy ra vui lòng thử lại")}})})}),$(document).ready(function(){var a,b=$("#skill").magicSuggest({placeholder:"Các kỹ năng yêu cầu",allowDuplicates:!1,maxSelection:5,data:"/valid/tags.php"});$(b).on("selectionchange",function(){var c=b.getSelection();a=c.map(function(a){return a.name}).join(",")}),$("#postNewJobForm").formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{title:{validators:{notEmpty:{message:"Vui lòng nhập tên dự án"}}},location:{validators:{notEmpty:{message:"Vui lòng chọn địa điểm"}}},skill:{validators:{notEmpty:{message:"Vui lòng chọn kỹ năng"}}},min_allowance:{validators:{notEmpty:{message:"Vui lòng nhập phí thấp nhất"},hex:{message:"Kinh phí phải là số"}}},max_allowance:{validators:{notEmpty:{message:"Vui lòng nhập phí cao nhất"},hex:{message:"Kinh phí phải là số"}}},job_description:{validators:{notEmpty:{message:"Vui lòng nhập mô tả chi tiết "}}}}}).on("success.form.fv",function(b){b.preventDefault();var c=$("#postNewJobForm").serializeArray(),d=$("#location .ms-sel-item").text(),e=$("#job_description").val();e=e.replace(/\r?\n/g,"<br />");var f=$(b.target);f.ajaxSubmit({url:"/job/postNewJob",type:"POST",data:{formValue:c,location:d,value:a,job_description:e},success:function(a){alert(a.mess),redirect("/chi-tiet-cong-viec/"+a.title+"/"+a.date)},error:function(){alert("Có lỗi xảy ra vui lòng thử lại")}})})}),$(document).ready(function(){$("#formAvatar").ajaxForm({beforeSend:function(){$(".progress").show()},uploadProgress:function(a,b,c,d){$(".progress-bar").width(d+"%"),$(".sr-only").html(d+"%")},success:function(a){$(".progress").hide(),alert("Cập nhật ảnh đại diện thành công"),$(".userAvatarUpload").attr("src","/"+a)}}),$(".progress").hide()}),$(document).on("ready",function(){$("#avatar").fileinput({browseClass:"btn btn-primary btn-block",showCaption:!1,showRemove:!1,showUpload:!1,allowedFileExtensions:["png","jpg","jpeg"],elErrorContainer:"#errorBlock"})}),$(document).on("ready",function(){$("#descriptionImg").fileinput({browseClass:"btn btn-primary btn-block",showCaption:!1,showRemove:!1,showUpload:!1,allowedFileExtensions:["png","jpg","jpeg"],elErrorContainer:"#errorBlock"})}),$("#register-name").keyup(function(){var a=$(this).val();$("#username_status").text("...."),""!=a&&$.post("/valid/client.php",{username:a},function(a){$("#username_status").text(a),"Tên đăng nhập đã được sử dụng"==a&&$("#regis_btn").attr("disabled",!0),"Tên đăng nhập có thể sử dụng"==a&&$("#regis_btn").attr("disabled",!1)})}),$("#register-email").keyup(function(){var a=$(this).val();$("#email_status").text("...."),""!=a&&$.post("/valid/client.php",{email:a},function(a){$("#email_status").text(a),"Email đã được sử dụng"==a&&$("#regis_btn").attr("disabled",!0),"Email có thể sử dụng"==a&&$("#regis_btn").attr("disabled",!1)})}),$(document).on("click",".details_pagi .pagination a",function(a){event.preventDefault();var b=getUrlVars()[3],c=getUrlVars()[4],d=c.split("-").reverse().join("-"),a=$(this).attr("href").split("page=")[1];$.ajax({url:"/comment/"+b+"/"+d+"?page="+a,data:{slug:b,date:d}}).done(function(a){$("#job_comment_post").html(a)})}),$(document).on("click",".paging_recruit .pagination a",function(a){event.preventDefault();var a=$(this).attr("href").split("page=")[1];$.ajax({url:"/list_recruit/?page="+a}).done(function(a){$("#recruit_pagi").html(a),$("html, body").animate({scrollTop:$(".container").position().top})})}),$(document).on("click",".paging_job .pagination a",function(a){event.preventDefault();var b=$(this).attr("href").split("page=")[1];getJob(b),$("html, body").animate({scrollTop:$(".container").position().top})}),$(document).on("click",".tag_job .pagination a",function(a){event.preventDefault();var b=getUrlVars()[3],a=$(this).attr("href").split("page=")[1];$.ajax({url:"/congviec/"+b+"?page="+a,data:{name:b}}).done(function(a){$("#ajax_pagi_tag").html(a),$("html, body").animate({scrollTop:$(".container").position().top})})}),$(document).ready(function(){$("#allowance").blur(function(){var a=$(this).val();$("#allowance").val(addCommas(a))})}),$(document).ready(function(){$("#min-allowance").blur(function(){var a=$(this).val();$("#min-allowance").val(addCommas(a))})}),$(document).ready(function(){$("#max-allowance").blur(function(){var a=$(this).val();$("#max-allowance").val(addCommas(a))})}),$(function(){var a=$("#message");$("td[contenteditable=true]").blur(function(){var b=$(this).attr("id"),c=$(this).text();$.post("/valid/comment.php",b+"="+c,function(b){""!=b&&(a.show(),a.text(b),setTimeout(function(){a.hide()},3e3))})})}),$(document).ready(function(){$("#message");$(".delComment").on("click",function(){if(ConfirmDelete()){var a=$(this).attr("data-id");$.ajax({url:"/deleteComment/"+a,type:"GET",async:!1,data:a,success:function(a){alert(a.mess)}}),$(this).parent().parent().remove()}})}),$("#forgot_pass").on("click",function(){$("#login").css("display","none"),$("#forgot_pass").css("margin-top","10%")}),$(function(){$("#location").magicSuggest({placeholder:"Khu vực",allowDuplicates:!1,maxSelection:1,data:"/valid/province.php"})}),$(".deleteCV").click(function(a){if(!ConfirmDelete())return!1;var b=$("input[name='_token']").val(),c=$(this).attr("data-id");$.ajax({url:"/cv/xoa-cv/"+c,type:"GET",data:{_token:b,id:c},success:function(a){alert(a.mess)}}),$(this).parent().parent().remove()}),$("#assignJob").click(function(a){a.preventDefault();var b=confirm("Bạn có chắc chắn muốn giao việc cho người này ?");if(b){var c=$(this).attr("data-post"),d=$(this).attr("data-comment"),e=$(this).attr("data-user"),f=$("input[name='_token']").val();$.ajax({url:"/assignCurJob",type:"POST",data:{job_id:c,user_assign:d,user_post:e,_token:f},error:function(){alert("Có lỗi vui lòng thử lại")},success:function(a){alert(a.mess)}})}}),$(".delJobUserPost").click(function(a){var b=confirm("Bạn có chắc chắn xóa công việc ?");if(b){var c=$(this).attr("data-id");$.ajax({url:"/delJobUserPost",type:"GET",async:!1,data:{job_id:c},error:function(){alert("Có lỗi vui lòng thử lại")},success:function(a){alert(a.mess)}}),$(this).parent().parent().remove()}}),$(document).ready(function(){$("#postNewRecruit").formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{title:{validators:{notEmpty:{message:"Vui lòng nhập tên dự án"}}},location:{validators:{notEmpty:{message:"Vui lòng chọn địa điểm"}}},salary_number:{validators:{notEmpty:{message:"Vui lòng nhập mức lương"}}},experience_year:{validators:{notEmpty:{message:"Vui lòng nhập kinh nghiệm"},hex:{message:"Kinh nghiệm phải là số"}}},quantity:{validators:{notEmpty:{message:"Vui lòng nhập phí số lượng"},hex:{message:"Vui lòng nhập số"}}},content:{validators:{notEmpty:{message:"Vui lòng nhập phí yêu cầu công việc"}}}}}).on("success.form.fv",function(a){a.preventDefault();var b=$("#postNewRecruit").serializeArray(),c=$("#location .ms-sel-item").text(),d=$("#content").val();d=d.replace(/\r?\n/g,"<br />");var e=$(a.target);e.ajaxSubmit({url:"/job/postNewRecruit",type:"POST",data:{formValue:b,location:c,job_description:d},success:function(a){alert(a.mess),redirect("/tin-tuyen-dung/"+a.title+"/"+a.date)},error:function(){alert("Có lỗi xảy ra vui lòng thử lại")}})})}),$(".delJobRecruit").click(function(a){var b=confirm("Bạn có chắc chắn xóa công việc ?");if(b){var c=$(this).attr("data-id");$.ajax({url:"/delJobRecruit",type:"GET",async:!1,data:{job_id:c},error:function(){alert("Có lỗi vui lòng thử lại")},success:function(a){alert(a.mess)}}),$(this).parent().parent().remove()}}),$(function(){$("#addClass").click(function(){$("#message_popup").addClass("popup-box-on")}),$("#removeClass").click(function(){$("#message_popup").removeClass("popup-box-on")})}),$("#sendMess").click(function(a){var b=$("#messageInput").val();if(""==b)return!1;var c=$("#user_avatar").attr("src"),d=$("#message_popup").data("auth"),e=$("#message_popup").data("userpost"),f=$("input[name='_token']").val();$.ajax({url:"/message/new",type:"POST",data:{message:b,from_user:d,to_user:e,_token:f}}).success(function(a){var e=(new Date).toTimeString().split(" ")[0],f='<div class="direct-chat-info clearfix"><span class="direct-chat-name pull-left">'+d+'</span></div><img alt="message user image" src="'+c+'" class="direct-chat-img"><div class="direct-chat-text">'+b+'</div><div class="direct-chat-info clearfix"><span class="direct-chat-timestamp pull-right">'+e+"</span></div>";$("#messages").append(f)}).error(function(){alert("Có lỗi xảy ra")})}),$(".conversation").click(function(){var a=$(this).attr("id"),b=$("input[name='_token']").val();$.ajax({url:"/getMessage",type:"GET",data:{name:a,_token:b}}).error(function(){alert("Có lỗi xảy ra vui lòng thử lại")}).success(function(b){$("#messages_details").html(b),$("#sendMessDetails").click(function(){var b=$("#messageContent").val();if(""==b)return!1;var c=$("#user_avatar").attr("src"),d=a,e=$("#welcome_user").text(),f=$("input[name='_token']").val();$.ajax({url:"/message/newMessageDetials",type:"POST",data:{message:b,to_user:d,_token:f}}).success(function(a){var d=(new Date).toTimeString().split(" ")[0],f='<div class="media msg "><a class="pull-left" href="#"><img class="media-object" style="width: 50px; height: 50px;" src="'+c+'"></a><div class="media-body"> <small class="pull-right time"><i class="fa fa-clock-o"></i> '+d+'</small><h5 class="media-heading">'+e+"</h5><small>"+b+"</small></div></div>";$("#messages_details").append(f),$("#messageContent").val("")}).error(function(){alert("Có lỗi xảy ra")})})})}),$("#allowance_filter").slider({min:1e5,max:1e7,value:[1e5,1e7],step:1e5,focus:!0}),$("#allowance_filter").on("slideStop",function(a){var b=a.value;$.ajax({url:"/get_job_by_filter",data:{rangeValue:b}}).error(function(){alert("Có lỗi xảy ra vui lòng thử lại")}).success(function(a){$("#jobs_content").html(a),$(".paging_job").hide()}).always(function(){console.log("complete")})});